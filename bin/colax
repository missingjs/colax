#!/bin/bash

self_dir=$(cd $(dirname $0) && pwd)

usage()
{
    local cmd=$(basename $0)
    cat << EOF
usage: $cmd <command> [options]

Commands:
    project        Create colax project

    server         Server operations.

    solu <lang>    Create or Submit solutions.

    worker         Worker management. E.g. $cmd worker <lang> [options...]
EOF
    exit 1
}

sub_command=$1

[ -z $sub_command ] && usage

# initiate global environments
export COLAX_HOME=$(realpath $self_dir/..)

colax_project_file=colax.conf

shift

case $sub_command in
    worker)
        language=$1
        [ -z $language ] && usage
        shift
        $COLAX_HOME/worker/$language/bin/worker.sh "$@"
        ;;
    server)
        $COLAX_HOME/server/bin/server "$@"
        ;;
    project)
        bash $self_dir/script.files/project.sh "$@"
        ;;
    solu)
        bash $self_dir/script.files/solution.sh "$@"
        ;;
    *)
        usage
        ;;
esac
